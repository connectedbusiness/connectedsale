define(["base64","shared/global","backbone"],function(n,t,e){var o=function(n,t){var e=n+":"+t,o=Base64.encode(e);return"Basic "+o},i=function(n){var e=o(t.Username,t.Password);n.setRequestHeader("Authorization",e)},r=e.Collection.extend({fetch:function(n){n||(n={}),null==n.timeout&&(n.timeout=3e5),n.beforeSend=i;var o=this.CheckInternet();if("No network connection"!=o)t.isBrowserMode||this.IntializeNetworkIndicator(),e.Collection.prototype.fetch.call(this,n);else{if(void 0==n.isLocalStorage||!n.isLocalStorage){var r=e.Collection.prototype.fetch.call(this,n);return r.abort(),r}t.isBrowserMode||this.IntializeNetworkIndicator(),e.Collection.prototype.fetch.call(this,n)}},paginate:function(n,t,e){t-=1;var o=this;return e<n?(o=_(o.rest(n*t)),o=_(o.last(n))):(o=_(o.rest(n*t)),o=_(o.first(n))),o.map(function(n){return n})},CheckInternet:function(){if(void 0!=navigator.connection&&void 0!=navigator.connection.type){var n=navigator.connection.type,e={};return e[Connection.UNKNOWN]="Unknown connection",e[Connection.ETHERNET]="Ethernet connection",e[Connection.WIFI]="WiFi connection",e[Connection.CELL_2G]="Cell 2G connection",e[Connection.CELL_3G]="Cell 3G connection",e[Connection.CELL_4G]="Cell 4G connection",e[Connection.NONE]="No network connection",this.connectionType=e[n]}return t.isBrowserMode=!0,this.connectionType="Browser Mode"},RequestError:function(n,t,e){switch(n.statusText){case"timeout":navigator.notification.alert("Request timed out. Check internet settings and try again.",null,t,"OK");break;case"abort":navigator.notification.alert("Unable to process request. Please check your internet settings.",null,t,"OK");break;default:e||(e="The remote server returned an error."),navigator.notification.alert(e,null,t,"OK")}},IntializeNetworkIndicator:function(){window.plugins?(window.plugins.cbNetworkActivity=cordova.require(t.Plugins.ActivityIndicator),window.plugins.cbNetworkActivity.ShowIndicator()):window.plugins={}}});return r});