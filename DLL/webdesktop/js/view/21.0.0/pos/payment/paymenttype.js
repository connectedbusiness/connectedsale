define(["jquery","mobile","underscore","backbone","shared/global","shared/method","shared/service","shared/enum","model/base","text!template/21.0.0/pos/payment/paymenttype.tpl.html"],function(t,e,n,a,s,o,i,r,d,h){var c=a.View.extend({_template:n.template(h),events:{"tap #btn-donePayment":"buttonDone_payment","tap #btn-cashPayment":"buttonCash_payment","tap #btn-checkPayment":"buttonCheck_payment","tap #btn-cardPayment":"buttonCard_payment","tap #btn-offlineCharge":"buttonOffline_payment","tap #btn-gift":"buttonApplyGift","tap #btn-loyalty":"buttonApplyLoyalty","tap #btn-suspendPayment":"buttonSuspend_payment","tap #btn-paymentOnAccount":"buttonPaymentOnAccount","tap #btn-returnPayment":"buttonReturn_payment","tap #btn-saveOrder":"buttonSaveOrder"},buttonDone_payment:function(t){t.preventDefault(),this.Hide()},buttonCash_payment:function(t){s.DejavooEnabled=!1,s.OfflineCharge=!1,s.SelectedPaymentType=r.PaymentType.Cash,t.preventDefault(),this.trigger("cash",this),this.Close()},buttonCheck_payment:function(t){s.DejavooEnabled=!1,s.OfflineCharge=!1,s.SelectedPaymentType=r.PaymentType.Check,t.preventDefault(),this.trigger("check",this),this.Close()},buttonCard_payment:function(t){s.DejavooEnabled=s.Preference.DejavooEnabled,s.OfflineCharge=s.Preference.DejavooEnabled,s.SelectedPaymentType=r.PaymentType.CreditCard,t.preventDefault(),(s.TransactionType===r.TransactionType.SalesRefund||s.TransactionType===r.TransactionType.Return)&&s.OfflineCharge?(this.trigger("cash",this),this.Close()):this.FetchCreditCardAllowSale()},buttonOffline_payment:function(t){s.DejavooEnabled=!1,s.OfflineCharge=!0,s.SelectedPaymentType=r.PaymentType.CreditCard,t.preventDefault(),(s.TransactionType===r.TransactionType.SalesRefund||s.TransactionType===r.TransactionType.Return)&&s.OfflineCharge?(this.trigger("cash",this),this.Close()):this.FetchCreditCardAllowSale()},FetchCreditCardAllowSale:function(){s.AllowSaleCreditPreference=!1;var t=this,e=new d;e.url=s.ServiceUrl+i.POS+o.GETCREDITCARDALLOWSALE,e.fetch({success:function(e,n,a){s.isBrowserMode||window.plugins.cbNetworkActivity.HideIndicator(),s.AllowSaleCreditPreference=n,s.OfflineCharge?t.ProceedToOfflineAction():t.ProceedToCardAction(),console.log(n)},error:function(e){s.isBrowserMode||window.plugins.cbNetworkActivity.HideIndicator(),t.ProceedToCardAction(),console.log(e)}})},ProceedToCardAction:function(){this.trigger("card",this),this.Close()},ProceedToOfflineAction:function(){this.trigger("offline",this),this.Close()},buttonApplyGift:function(t){t.preventDefault(),s.DejavooEnabled=!1,s.OfflineCharge=!0,this.trigger("gift",this),this.Close()},buttonApplyLoyalty:function(t){t.preventDefault(),s.DejavooEnabled=!1,s.OfflineCharge=!0,this.trigger("loyalty",this),this.Close()},buttonSuspend_payment:function(t){t.preventDefault(),s.DejavooEnabled=!1,s.OfflineCharge=!0,this.trigger("suspend",this),this.Close()},buttonPaymentOnAccount:function(t){t.preventDefault(),s.DejavooEnabled=!1,s.OfflineCharge=!0,this.trigger("onAccount",this),this.Close()},buttonSaveOrder:function(t){t.preventDefault(),this.trigger("onAccount",this),this.Close()},buttonReturn_payment:function(t){t.preventDefault(),this.trigger("onAccount",this),this.Close()},initialize:function(){this.isPaid=this.options.isPaid,this.render()},enablePaymentOptionButtons:function(){s.Preference.UseForcePayment?(t("#btn-cashPayment").addClass("ui-disabled"),t("#btn-cashPayment").attr("disabled","true"),t("#btn-checkPayment").addClass("ui-disabled"),t("#btn-checkPayment").attr("disabled","true"),t("#btn-cardPayment").addClass("ui-disabled"),t("#btn-cardPayment").attr("disabled","true"),t("#btn-gift").addClass("ui-disabled"),t("#btn-gift").attr("disabled","true"),t("#btn-loyalty").addClass("ui-disabled"),t("#btn-loyalty").attr("disabled","true"),t("#btn-paymentOnAccount").addClass("ui-disabled"),t("#btn-paymentOnAccount").attr("disabled","true"),t("#btn-suspendPayment").addClass("ui-disabled"),t("#btn-suspendPayment").attr("disabled","true")):(t("#btn-cashPayment").removeClass("ui-disabled"),t("#btn-cashPayment").removeAttr("disabled","true"),t("#btn-checkPayment").removeClass("ui-disabled"),t("#btn-checkPayment").removeAttr("disabled","true"),t("#btn-cardPayment").removeClass("ui-disabled"),t("#btn-cardPayment").removeAttr("disabled","true"),t("#btn-gift").removeClass("ui-disabled"),t("#btn-gift").removeAttr("disabled","true"),t("#btn-loyalty").removeClass("ui-disabled"),t("#btn-loyalty").removeAttr("disabled","true"),t("#btn-paymentOnAccount").removeClass("ui-disabled"),t("#btn-paymentOnAccount").removeAttr("disabled","true"),t("#btn-suspendPayment").removeClass("ui-disabled"),t("#btn-suspendPayment").removeAttr("disabled","true"))},render:function(){switch(this.$el.html(this._template),this.enablePaymentOptionButtons(),s.TransactionType){case r.TransactionType.Sale:case r.TransactionType.Suspend:this.isPaid?t("#btn-suspendPayment").hide():t("#btn-suspendPayment").show(),t("#btn-cashPayment").show(),t("#btn-checkPayment").show(),t("#btn-cardPayment").show(),t("#btn-paymentOnAccount").show(),t("#btn-gift").show(),t("#btn-loyalty").show(),t("#btn-returnPayment").hide(),t("#btn-saveOrder").hide();break;case r.TransactionType.Order:t("#btn-cashPayment").show(),t("#btn-checkPayment").show(),t("#btn-cardPayment").show(),t("#btn-paymentOnAccount").hide(),t("#btn-gift").show(),t("#btn-loyalty").show(),t("#btn-returnPayment").hide(),t("#btn-saveOrder").show(),t("#btn-suspendPayment").hide();break;case r.TransactionType.Return:t("#btn-cashPayment").show(),t("#btn-checkPayment").show(),t("#btn-cardPayment").show(),t("#btn-returnPayment").show(),t("#btn-gift").hide(),t("#btn-loyalty").hide(),t("#btn-paymentOnAccount").hide(),t("#btn-saveOrder").hide(),t("#btn-suspendPayment").hide();break;case r.TransactionType.UpdateInvoice:case r.TransactionType.Recharge:this.isPaid?t("#btn-suspendPayment").hide():t("#btn-suspendPayment").show(),t("#btn-cashPayment").show(),t("#btn-checkPayment").show(),t("#btn-cardPayment").show(),t("#btn-paymentOnAccount").show(),t("#btn-gift").show(),t("#btn-loyalty").show(),t("#btn-saveOrder").hide(),t("#btn-returnPayment").hide();break;case r.TransactionType.UpdateOrder:t("#btn-cashPayment").show(),t("#btn-checkPayment").show(),t("#btn-cardPayment").show(),t("#btn-saveOrder").show(),t("#btn-gift").show(),t("#btn-loyalty").show(),t("#btn-paymentOnAccount").hide(),t("#btn-returnPayment").hide(),t("#btn-suspendPayment").hide();break;case r.TransactionType.ConvertQuote:t("#btn-cashPayment").show(),t("#btn-checkPayment").show(),t("#btn-cardPayment").show(),t("#btn-saveOrder").show(),t("#btn-gift").show(),t("#btn-loyalty").show(),t("#btn-paymentOnAccount").hide(),t("#btn-returnPayment").hide(),t("#btn-suspendPayment").hide();break;case r.TransactionType.ConvertOrder:t("#btn-cashPayment").show(),t("#btn-checkPayment").show(),t("#btn-cardPayment").show(),t("#btn-paymentOnAccount").show(),t("#btn-gift").show(),t("#btn-loyalty").show(),t("#btn-returnPayment").hide(),t("#btn-saveOrder").hide(),t("#btn-suspendPayment").hide();break;case r.TransactionType.SalesPayment:t("#btn-cashPayment").show(),t("#btn-checkPayment").show(),t("#btn-cardPayment").show(),t("#btn-paymentOnAccount").show(),t("#btn-gift").show(),t("#btn-loyalty").show(),t("#btn-returnPayment").hide(),t("#btn-saveOrder").hide(),t("#btn-suspendPayment").hide();break;case r.TransactionType.SalesRefund:t("#btn-cashPayment").show(),t("#btn-checkPayment").show(),t("#btn-cardPayment").show(),t("#btn-returnPayment").show(),t("#btn-gift").hide(),t("#btn-loyalty").hide(),t("#btn-paymentOnAccount").hide(),t("#btn-saveOrder").hide(),t("#btn-suspendPayment").hide()}t("#main-transaction-blockoverlay").show(),this.$("#paymentTypeBody").trigger("create")},CheckIfIsTrackLoyalty:function(){s.CustomerHasLoyalty?t("#btn-loyalty").show():(t("#btn-loyalty").hide(),t("#btn-paymentOnAccount").is(":visible")?t("#btn-cashPayment").addClass("box2"):t("#btn-cashPayment").addClass("box3"))},Show:function(t){this.isPaid=t,this.$el.show(),this.render()},Close:function(){this.$("#paymentType").remove()},Hide:function(){t("#main-transaction-blockoverlay").hide(),this.$el.html(""),this.$el.hide()}});return c});